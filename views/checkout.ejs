<%- include('partials/header', { title: 'checkout'}) %>            

    <!-- NAVBAR (stessa del catalogo) -->
    <nav class="navbar navbar-expand-md p-1 border-bottom sticky-top bg-white">
        <div class="container-fluid">
            <a class="navbar-brand name ms-4 my-1" href="index.html">
                <svg xmlns="http://www.w3.org/2000/svg" width="30" height="60" viewBox="0 0 640 560" fill="currentColor" class="bi bi-dumbbell">
                    <path d="M96 64c0-17.7 14.3-32 32-32l32 0c17.7 0 32 14.3 32 32l0 160 0 64 0 160c0 17.7-14.3 32-32 32l-32 0c-17.7 0-32-14.3-32-32l0-64-32 0c-17.7 0-32-14.3-32-32l0-64c-17.7 0-32-14.3-32-32s14.3-32 32-32l0-64c0-17.7 14.3-32 32-32l32 0 0-64zm448 0l0 64 32 0c17.7 0 32 14.3 32 32l0 64c17.7 0 32 14.3 32 32s-14.3 32-32 32l0 64c0 17.7-14.3 32-32 32l-32 0 0 64c0 17.7-14.3 32-32 32l-32 0c-17.7 0-32-14.3-32-32l0-160 0-64 0-160c0-17.7 14.3-32 32-32l32 0c17.7 0 32 14.3 32 32zM416 224l0 64-192 0 0-64 192 0z"/>
                </svg>
                Trainly
            </a>
            <div class="d-flex align-items-center me-3">
                <a href="/catalogo" class="btn btn-outline-secondary">‚Üê Torna al catalogo</a>
            </div>
            
        </div>
    </nav>

    <!-- MAIN CONTENT -->
    <div class="container my-5">
        <!-- Indicatore step -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="d-flex justify-content-center align-items-center">
                    <div class="text-center me-4">
                        <div class="step-indicator">1</div>
                        <small class="mt-2 d-block">Carrello</small>
                    </div>
                    <div class="border-top flex-grow-1 mx-3" style="height: 1px; max-width: 100px;"></div>
                    <div class="text-center me-4">
                        <div class="step-indicator">2</div>
                        <small class="mt-2 d-block">Checkout</small>
                    </div>
                    <div class="border-top flex-grow-1 mx-3" style="height: 1px; max-width: 100px;"></div>
                    <div class="text-center">
                        <div class="step-indicator bg-secondary">3</div>
                        <small class="mt-2 d-block">Conferma</small>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <!-- Form Checkout -->
            <div class="col-lg-8 mb-4">
                <div class="card checkout-card">
                    <div class="card-body p-4">
                        <h4 class="card-title mb-4">Completa il tuo ordine</h4>
                        
                        <form id="checkoutForm">
                            <!-- Dati personali -->
                            <div class="mb-4">
                                <h5 class="mb-3">Dati personali</h5>
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label for="firstName" class="form-label">Nome *</label>
                                        <input type="text" class="form-control" id="firstName" required>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label for="lastName" class="form-label">Cognome *</label>
                                        <input type="text" class="form-control" id="lastName" required>
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <label for="email" class="form-label">Email *</label>
                                    <input type="email" class="form-control" id="email" required>
                                </div>
                                <div class="mb-3">
                                    <label for="phone" class="form-label">Telefono</label>
                                    <input type="tel" class="form-control" id="phone">
                                </div>
                            </div>

                            <!-- Dati di fatturazione -->
                            <div class="mb-4">
                                <h5 class="mb-3">Dati di fatturazione</h5>
                                <div class="mb-3">
                                    <label for="address" class="form-label">Indirizzo *</label>
                                    <input type="text" class="form-control" id="address" required>
                                </div>
                                <div class="row">
                                    <div class="col-md-4 mb-3">
                                        <label for="city" class="form-label">Citt√† *</label>
                                        <input type="text" class="form-control" id="city" required>
                                    </div>
                                    <div class="col-md-4 mb-3">
                                        <label for="postalCode" class="form-label">CAP *</label>
                                        <input type="text" class="form-control" id="postalCode" required>
                                    </div>
                                    <div class="col-md-4 mb-3">
                                        <label for="country" class="form-label">Paese *</label>
                                        <select class="form-control" id="country" required>
                                            <option value="">Seleziona paese</option>
                                            <option value="IT" selected>Italia</option>
                                            <option value="CH">Svizzera</option>
                                            <option value="FR">Francia</option>
                                            <option value="DE">Germania</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <!-- Metodo di pagamento -->
                            <div class="mb-4">
                                <h5 class="mb-3">Metodo di pagamento</h5>
                                <div class="mb-3">
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="paymentMethod" id="creditCard" value="credit_card" checked>
                                        <label class="form-check-label" for="creditCard">
                                            üí≥ Carta di credito/debito
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="paymentMethod" id="paypal" value="paypal">
                                        <label class="form-check-label" for="paypal">
                                            üÖøÔ∏è PayPal
                                        </label>
                                    </div>
                                </div>

                                <div id="creditCardDetails">
                                    <div class="row">
                                        <div class="col-md-8 mb-3">
                                            <label for="cardNumber" class="form-label">Numero carta *</label>
                                            <input type="text" class="form-control" id="cardNumber" placeholder="1234 5678 9012 3456" maxlength="19">
                                        </div>
                                        <div class="col-md-4 mb-3">
                                            <label for="cvv" class="form-label">CVV *</label>
                                            <input type="text" class="form-control" id="cvv" placeholder="123" maxlength="3">
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label for="expiryMonth" class="form-label">Mese scadenza *</label>
                                            <select class="form-control" id="expiryMonth">
                                                <option value="">Mese</option>
                                                <option value="01">01</option>
                                                <option value="02">02</option>
                                                <option value="03">03</option>
                                                <option value="04">04</option>
                                                <option value="05">05</option>
                                                <option value="06">06</option>
                                                <option value="07">07</option>
                                                <option value="08">08</option>
                                                <option value="09">09</option>
                                                <option value="10">10</option>
                                                <option value="11">11</option>
                                                <option value="12">12</option>
                                            </select>
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label for="expiryYear" class="form-label">Anno scadenza *</label>
                                            <select class="form-control" id="expiryYear">
                                                <option value="">Anno</option>
                                                <option value="2025">2025</option>
                                                <option value="2026">2026</option>
                                                <option value="2027">2027</option>
                                                <option value="2028">2028</option>
                                                <option value="2029">2029</option>
                                                <option value="2030">2030</option>
                                                <option value="2031">2031</option>
                                                <option value="2032">2032</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>

                                <div id="paypalDetails" style="display: none;">
                                    <div class="alert alert-info" role="alert">
                                        Cliccando su "Conferma ordine" verrai reindirizzato al sito di PayPal per completare il pagamento in modo sicuro.
                                    </div>
                                </div>
                            </div>

                            <!-- Note aggiuntive -->
                            <div class="mb-4">
                                <label for="notes" class="form-label">Note aggiuntive (opzionale)</label>
                                <textarea class="form-control" id="notes" rows="3" placeholder="Eventuali richieste speciali..."></textarea>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Riepilogo ordine -->
            <div class="col-lg-4">
                <div class="card checkout-card sticky-top" style="top: 100px;">
                    <div class="card-body p-4">
                        <h5 class="card-title mb-4">Riepilogo ordine</h5>
                        
                        <!-- Prodotti nel carrello -->
                        <div id="checkoutItems">
                            <!-- JS -->
                        </div>

                        <hr>

                        <!-- Totali -->
                        <div class="d-flex justify-content-between mb-2">
                            <span>Subtotale:</span>
                            <span id="subtotal">‚Ç¨0.00</span>
                        </div>
                        <div class="d-flex justify-content-between mb-2">
                            <span>Tasse (22%):</span>
                            <span id="taxes">‚Ç¨0.00</span>
                        </div>
                        <hr>
                        <div class="d-flex justify-content-between mb-4">
                            <strong>Totale:</strong>
                            <strong id="total">‚Ç¨0.00</strong>
                        </div>

                        <!-- Bottone conferma -->
                        <button type="button" class="btn btn-primary-custom text-white w-100 py-2" id="confirmOrderBtn">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-credit-card me-2" viewBox="0 0 16 16">
                                <path d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2zm2-1a1 1 0 0 0-1 1v1h14V4a1 1 0 0 0-1-1zm13 4H1v5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1z"/>
                                <path d="M2 10a1 1 0 0 1 1-1h1a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1z"/>
                            </svg>
                            Conferma ordine
                        </button>

                        <div class="text-center mt-2">
                            <small class="text-muted">Pagamento sicuro e protetto</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast per conferma ordine -->
    <div class="toast-container position-fixed bottom-0 end-0 p-3">
        <div id="orderSuccessToast" class="toast align-items-center text-bg-success border-0" role="alert" aria-live="assertive" aria-atomic="true">
            <div class="d-flex">
                <div class="toast-body">
                    Ordine confermato con successo! Riceverai una email di conferma.
                </div>
                <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Chiudi"></button>
            </div>
        </div>
    </div>

    <!-- Bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" 
    integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" 
    crossorigin="anonymous"></script>
    
    <script src="/js/checkout.js"></script>
</body>
</html>