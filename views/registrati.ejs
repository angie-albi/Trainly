<%- include('partials/header', { title: 'Registrati'}) %>
  <%- include('partials/navbar', { currentPage: 'registrati' }) %>

    <!-- REGISTRAZIONE -->
    <main class="d-flex justify-content-center align-items-center">
      <div class="registration-container m-auto p-3 px-4 shadow rounded">
        <div class="registration-title text-center fw-bold">Ti do il benvenuto a</div>
        <div class="registration-brand text-center fw-bold text-primary mb-2">Trainly</div>
      
        <!-- Messaggi di errore o successo -->
        <% if (locals.errorMessage && errorMessage.length > 0) { %>
          <div class="alert alert-danger mt-3" role="alert">
            <%= errorMessage %>
          </div>
        <% } %>
        
        <% if (locals.successMessage && successMessage.length > 0) { %>
          <div class="alert alert-success mt-3" role="alert">
            <%= successMessage %>
          </div>
        <% } %>
      
        <form id="registrationForm" action="/registrati" method="POST">
          <div class="row mb-3">
            <div class="col-md-6">
              <label for="email" class="form-label">Email </label>
              <input type="email" 
                     class="form-control" 
                     id="email" 
                     name="email"
                     placeholder="nome@gmail.com" 
                     value="<%= locals.formData ? formData.email || '' : '' %>"
                     autocomplete="email" 
                     required>
            </div>
            <div class="col-md-6">
              <label for="confirmEmail" class="form-label">Conferma email </label>
              <input type="email" 
                     class="form-control" 
                     id="confirmEmail" 
                     name="confirmEmail"
                     placeholder="nome@gmail.com" 
                     autocomplete="email" 
                     required>
            </div>
          </div>
          
          <div class="row mb-3">
            <div class="col-md-6">
              <label for="nome" class="form-label">Nome </label>
              <input type="text" 
                     class="form-control" 
                     id="nome" 
                     name="nome"
                     value="<%= locals.formData ? formData.nome || '' : '' %>"
                     placeholder="Mario" 
                     required>
            </div>
            <div class="col-md-6">
              <label for="cognome" class="form-label">Cognome </label>
              <input type="text" 
                     class="form-control" 
                     id="cognome" 
                     name="cognome"
                     value="<%= locals.formData ? formData.cognome || '' : '' %>"
                     placeholder="Rossi" 
                     required>
            </div>
          </div>
          
          <div class="row">
            <div class="col-md-6">
              <label for="password" class="form-label">Nuova password </label>
              <div class="input-group">
                <input type="password" 
                       class="form-control" 
                       aria-describedby="passwordHelpInline" 
                       id="password" 
                       name="password"
                       placeholder="Password123&" 
                       required>
                <span class="input-group-text" id="togglePassword">
                  <i class="bi bi-eye-slash" id="toggleIcon"></i>
                </span>
              </div>
              <div id="passwordStrength" style="display: none;" class="mt-1"></div>
            </div>
            <div class="col-md-6">
              <label for="confirmPassword" class="form-label">Ripeti password </label>
              <div class="input-group">
                <input type="password" 
                       class="form-control" 
                       aria-describedby="passwordHelpInline" 
                       id="confirmPassword" 
                       name="confirmPassword"
                       placeholder="Password123&" 
                       required>
                <span class="input-group-text" id="toggleConfirmPassword">
                  <i class="bi bi-eye-slash" id="toggleConfirmIcon"></i>
                </span>
              </div>
            </div>
            <div class="form-text">
                <small class="text-muted ps-1"> Deve contenere almeno 8 caratteri con maiuscole, minuscole, numeri e simboli</small>
              </div>
          </div>
          
          <!-- Campo tipo utente nascosto o dropdown se necessario -->
          <input type="hidden" name="tipo" value="utente">
          
          <div class="text-center">
            <button type="submit" class="btn btn-registration mt-3 py-2 px-3 fw-bold">REGISTRATI</button>
          </div>
          
          <div class="text-center mt-3">
            <p class="h7 help mb-2">Hai gi√† un account? <a class="login" href="/accedi">Accedi</a></p>
          </div>
        </form>
      </div>
    </main>

<%- include('partials/footer', { extraJS: ['/js/registrati.js', '/js/password.js'] }) %>